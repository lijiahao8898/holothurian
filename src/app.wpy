<script>
    import wepy from 'wepy';
    import 'wepy-async-function';

    import {setStore} from 'wepy-redux';
    import configStore from './store';

    const store = configStore();
    setStore(store);

    export default class extends wepy.app {
        config = {
            pages: [
                'pages/list',
                'pages/cart',
                'pages/mine',
                'pages/index/index',
                'pages/authorization',
                'pages/goodsDetail',
                'pages/address/address',
                'pages/address/addressAdd',
                'pages/address/addressSelect',
                'pages/orderConfirm',
                'pages/orderDetail',
                'pages/orderLists',
                'pages/result/paySuccess',
                'pages/result/payFail',
            ],
            window: {
                backgroundTextStyle: 'light',
                navigationBarBackgroundColor: '#2d8cf0',
                navigationBarTitleText: '健锋岛海参',
                navigationBarTextStyle: 'white',
                enablePullDownRefresh: true,
                onReachBottomDistance: 20,
                backgroundColor: '#f2f8f9'
            },
            tabBar: {
                color: '#c7cdce',
                selectedColor: '#2d8cf0',
                backgroundColor: '#fff',
                list: [{
                    pagePath: 'pages/index/index',
                    text: '首页',
                    iconPath: 'images/home.png',
                    selectedIconPath: 'images/home_a.png'
                }, {
                    pagePath: 'pages/list',
                    text: '列表',
                    iconPath: 'images/list.png',
                    selectedIconPath: 'images/list_a.png'
                }, {
                    pagePath: 'pages/cart',
                    text: '购物车',
                    iconPath: 'images/cart.png',
                    selectedIconPath: 'images/cart_a.png'
                }, {
                    pagePath: 'pages/mine',
                    text: '我的',
                    iconPath: 'images/mine.png',
                    selectedIconPath: 'images/mine_a.png'
                }]
            },
            debug: false
        };

        globalData = {
            userInfo: null,
            appLogo: '../images/logo.jpeg',
            appName: '健锋岛海参',
            appDesc: '长岛县优质海参，来自北纬39°，国家品牌注册商标产品。',
            appId: '',
            appSecret: ''
        };

        constructor () {
            super();
            this.use('promisify');
            this.use('requestfix');
            // 拦截器
            this.intercept('request', {
                config (p) {
                    const token = wepy.getStorageSync('token');
                    if(!p.header) {
                        p.header = {}
                    }
                    token && (p.header['token'] = token);
                    return p
                },
                success (p) {
                    // 可以在这里对收到的响应数据对象进行加工处理
                    // console.log('request success: ', p);
                    // 必须返回响应数据对象，否则后续无法对响应数据进行处理
                    return p;
                },
                fail (p) {
                    // console.log('request fail: ', p);
                    // 必须返回响应数据对象，否则后续无法对响应数据进行处理
                    return p;
                },

            });
        }

        onLaunch () {
            console.log(wepy);
            console.log(wepy.getUpdateManager);
            // this.getUserSystemInfo();
            // this.getAndDownloadNewVersion();
        }

        // 更新版本
        getAndDownloadNewVersion () {
            const updateManager = wx.getUpdateManager();

            updateManager.onCheckForUpdate(res => {
                // 请求完新版本信息的回调
                console.log(res);
            });

            updateManager.onUpdateReady(() => {
                // 新的版本已经下载好，调用 applyUpdate 应用新版本并重启
                wepy.showModal({
                    title: '更新提示',
                    content: '新版本已经准备好，是否重启应用？',
                    success(res) {
                        if (res.confirm) {
                            // 新的版本已经下载好，调用 applyUpdate 应用新版本并重启
                            updateManager.applyUpdate()
                        }
                    }
                });
            })
        }

        // 获取用户信息
        getUserInfo (cb) {
            if (this.globalData.userInfo) {
                cb && cb(this.globalData.userInfo)
            } else {
                const value = wx.getStorageSync('userInfo');
                cb && cb(value);
            }
        }

        getUserSystemInfo () {
            const info = JSON.stringify(wepy.getSystemInfoSync());
            wepy.showModal({
                title: '系统信息提示',
                content: info,
                success(res) {
                    if (res.confirm) {

                    }
                }
            });
        }
    }
</script>

<style lang="scss">
    @import './assets/custom';

    @font-face {font-family: "iconfont";
        src: url('iconfont.eot?t=1563501544063'); /* IE9 */
        src: url('iconfont.eot?t=1563501544063#iefix') format('embedded-opentype'), /* IE6-IE8 */
        url('data:application/x-font-woff2;charset=utf-8;base64,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') format('woff2'),
        url('iconfont.woff?t=1563501544063') format('woff'),
        url('iconfont.ttf?t=1563501544063') format('truetype'), /* chrome, firefox, opera, Safari, Android, iOS 4.2+ */
        url('iconfont.svg?t=1563501544063#iconfont') format('svg'); /* iOS 4.1- */
    }

    .iconfont {
        font-family: "iconfont" !important;
        font-size: 16px;
        font-style: normal;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    .icon-friend:before {
        content: "\e647";
    }

    .icon-pinpai:before {
        content: "\e664";
    }

    .icon-daishouhuo:before {
        content: "\e608";
    }

    .icon-share:before {
        content: "\e63b";
    }

    .icon-qr-code:before {
        content: "\e609";
    }

    .icon-No-data:before {
        content: "\e673";
    }

    .icon-daifukuan2-copy:before {
        content: "\e603";
    }

    .icon-gouwuche:before {
        content: "\e600";
    }

    .icon-fahuotixing:before {
        content: "\e604";
    }

    .icon-liebiao:before {
        content: "\e721";
    }

    .icon-wodedangxuan:before {
        content: "\e601";
    }

    .icon-zhifuchenggong:before {
        content: "\e635";
    }

    .icon-zhifushibai:before {
        content: "\e6d8";
    }

    .icon-yemian-copy:before {
        content: "\e602";
    }

    .container {
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: space-between;
        box-sizing: border-box;
    }
</style>
