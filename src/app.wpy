<script>
    import wepy from 'wepy';
    import 'wepy-async-function';

    import {setStore} from 'wepy-redux';
    import configStore from './store';

    const store = configStore();
    setStore(store);

    export default class extends wepy.app {
        config = {
            pages: [
                'pages/mine',
                'pages/list',
                'pages/cart',
                'pages/index/index',
                'pages/authorization',
                'pages/goodsDetail',
                'pages/address/address',
                'pages/address/addressAdd',
                'pages/address/addressSelect',
                'pages/orderConfirm',
                'pages/orderDetail',
                'pages/orderLists'
            ],
            window: {
                backgroundTextStyle: 'light',
                navigationBarBackgroundColor: '#2d8cf0',
                navigationBarTitleText: '健锋岛海参',
                navigationBarTextStyle: 'white',
                enablePullDownRefresh: true,
                onReachBottomDistance: 20,
                backgroundColor: '#f2f8f9'
            },
            tabBar: {
                color: '#c7cdce',
                selectedColor: '#2d8cf0',
                backgroundColor: '#fff',
                list: [{
                    pagePath: 'pages/index/index',
                    text: '首页',
                    iconPath: 'images/home.png',
                    selectedIconPath: 'images/home_a.png'
                }, {
                    pagePath: 'pages/list',
                    text: '列表',
                    iconPath: 'images/list.png',
                    selectedIconPath: 'images/list_a.png'
                }, {
                    pagePath: 'pages/cart',
                    text: '购物车',
                    iconPath: 'images/cart.png',
                    selectedIconPath: 'images/cart_a.png'
                }, {
                    pagePath: 'pages/mine',
                    text: '我的',
                    iconPath: 'images/mine.png',
                    selectedIconPath: 'images/mine_a.png'
                }]
            },
            debug: false
        };

        globalData = {
            userInfo: null,
            appLogo: '../images/logo.jpeg',
            appName: '健锋岛海参',
            appDesc: '长岛县优质海参，来自北纬39°，国家品牌注册商标产品。',
            appId: '',
            appSecret: ''
        };

        constructor () {
            super();
            this.use('promisify');
            this.use('requestfix');
            // 拦截器
            this.intercept('request', {
                config (p) {
                    const token = wepy.getStorageSync('token');
                    if(!p.header) {
                        p.header = {}
                    }
                    token && (p.header['token'] = token);
                    return p
                },
                success (p) {
                    // 可以在这里对收到的响应数据对象进行加工处理
                    // console.log('request success: ', p);
                    // 必须返回响应数据对象，否则后续无法对响应数据进行处理
                    return p;
                },
                fail (p) {
                    // console.log('request fail: ', p);
                    // 必须返回响应数据对象，否则后续无法对响应数据进行处理
                    return p;
                },

            });
        }

        onLaunch () {
            console.log(wepy);
            console.log(wepy.getUpdateManager);
            // this.getUserSystemInfo();
            // this.getAndDownloadNewVersion();
        }

        // 更新版本
        getAndDownloadNewVersion () {
            const updateManager = wx.getUpdateManager();

            updateManager.onCheckForUpdate(res => {
                // 请求完新版本信息的回调
                console.log(res);
            });

            updateManager.onUpdateReady(() => {
                // 新的版本已经下载好，调用 applyUpdate 应用新版本并重启
                wepy.showModal({
                    title: '更新提示',
                    content: '新版本已经准备好，是否重启应用？',
                    success(res) {
                        if (res.confirm) {
                            // 新的版本已经下载好，调用 applyUpdate 应用新版本并重启
                            updateManager.applyUpdate()
                        }
                    }
                });
            })
        }

        // 获取用户信息
        getUserInfo (cb) {
            if (this.globalData.userInfo) {
                cb && cb(this.globalData.userInfo)
            } else {
                const value = wx.getStorageSync('userInfo');
                cb && cb(value);
            }
        }

        getUserSystemInfo () {
            const info = JSON.stringify(wepy.getSystemInfoSync());
            wepy.showModal({
                title: '系统信息提示',
                content: info,
                success(res) {
                    if (res.confirm) {

                    }
                }
            });
        }
    }
</script>

<style lang="scss">
    @import './assets/custom';

    @font-face {font-family: "iconfont";
        src: url('iconfont.eot?t=1562742573357'); /* IE9 */
        src: url('iconfont.eot?t=1562742573357#iefix') format('embedded-opentype'), /* IE6-IE8 */
        url('data:application/x-font-woff2;charset=utf-8;base64,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') format('woff2'),
        url('iconfont.woff?t=1562742573357') format('woff'),
        url('iconfont.ttf?t=1562742573357') format('truetype'), /* chrome, firefox, opera, Safari, Android, iOS 4.2+ */
        url('iconfont.svg?t=1562742573357#iconfont') format('svg'); /* iOS 4.1- */
    }

    .iconfont {
        font-family: "iconfont" !important;
        font-size: 16px;
        font-style: normal;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    .icon-pinpai:before {
        content: "\e664";
    }

    .icon-daishouhuo:before {
        content: "\e608";
    }

    .icon-share:before {
        content: "\e63b";
    }

    .icon-No-data:before {
        content: "\e673";
    }

    .icon-daifukuan2-copy:before {
        content: "\e603";
    }

    .icon-gouwuche:before {
        content: "\e600";
    }

    .icon-fahuotixing:before {
        content: "\e604";
    }

    .icon-liebiao:before {
        content: "\e721";
    }

    .icon-wodedangxuan:before {
        content: "\e601";
    }

    .icon-yemian-copy:before {
        content: "\e602";
    }

    .container {
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: space-between;
        box-sizing: border-box;
    }
</style>
